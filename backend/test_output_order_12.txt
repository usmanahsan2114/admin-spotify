
> backend@1.0.0 test
> cross-env NODE_ENV=test jest tests/orderController.test.js

  console.log
    TEST DEBUG: db.Product.update is [Function: mockConstructor] {
      _isMockFunction: true,
      getMockImplementation: [Function (anonymous)],
      mock: [Getter/Setter],
      mockClear: [Function (anonymous)],
      mockReset: [Function (anonymous)],
      mockRestore: [Function (anonymous)],
      mockReturnValueOnce: [Function (anonymous)],
      mockResolvedValueOnce: [Function (anonymous)],
      mockRejectedValueOnce: [Function (anonymous)],
      mockReturnValue: [Function (anonymous)],
      mockResolvedValue: [Function (anonymous)],
      mockRejectedValue: [Function (anonymous)],
      mockImplementationOnce: [Function (anonymous)],
      withImplementation: [Function: bound withImplementation],
      mockImplementation: [Function (anonymous)],
      mockReturnThis: [Function (anonymous)],
      mockName: [Function (anonymous)],
      getMockName: [Function (anonymous)],
      [Symbol(nodejs.dispose)]: [Function (anonymous)]
    }

      at Object.log (tests/orderController.test.js:204:21)

  console.log
    TEST DEBUG: db.Product.update return undefined

      at Object.log (tests/orderController.test.js:206:21)

  console.log
    TEST DEBUG: sequelize.transaction return undefined

      at Object.log (tests/orderController.test.js:209:21)

  console.log
    DEBUG: createOrder called

      at log (controllers/orderController.js:351:13)

  console.log
    DEBUG: sequelize is: {
      transaction: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      literal: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      }
    }

      at log (controllers/orderController.js:352:13)

  console.log
    DEBUG: Product found: yes

      at log (controllers/orderController.js:386:17)

  console.log
    DEBUG: Catch block entered TypeError: (intermediate value) is not iterable
        at createOrder (C:\Apex IT Solutions\apex dashboard\admin-spotify\backend\controllers\orderController.js:397:32)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      at log (controllers/orderController.js:535:17)

  console.log
    DEBUG ERROR BODY (Create): {}

      at Object.log (tests/orderController.test.js:241:25)

  console.log
    DEBUG: createOrder called

      at log (controllers/orderController.js:351:13)

  console.log
    DEBUG: sequelize is: {
      transaction: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      },
      literal: [Function: mockConstructor] {
        _isMockFunction: true,
        getMockImplementation: [Function (anonymous)],
        mock: [Getter/Setter],
        mockClear: [Function (anonymous)],
        mockReset: [Function (anonymous)],
        mockRestore: [Function (anonymous)],
        mockReturnValueOnce: [Function (anonymous)],
        mockResolvedValueOnce: [Function (anonymous)],
        mockRejectedValueOnce: [Function (anonymous)],
        mockReturnValue: [Function (anonymous)],
        mockResolvedValue: [Function (anonymous)],
        mockRejectedValue: [Function (anonymous)],
        mockImplementationOnce: [Function (anonymous)],
        withImplementation: [Function: bound withImplementation],
        mockImplementation: [Function (anonymous)],
        mockReturnThis: [Function (anonymous)],
        mockName: [Function (anonymous)],
        getMockName: [Function (anonymous)],
        [Symbol(nodejs.dispose)]: [Function (anonymous)]
      }
    }

      at log (controllers/orderController.js:352:13)

  console.log
    DEBUG: Product found: no

      at log (controllers/orderController.js:386:17)

  console.log
    DEBUG: Catch block entered TypeError: Cannot read properties of undefined (reading 'rollback')
        at rollback (C:\Apex IT Solutions\apex dashboard\admin-spotify\backend\controllers\orderController.js:389:21)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      at log (controllers/orderController.js:535:17)

  console.log
    DEBUG ERROR BODY (Product Not Found): {}

      at Object.log (tests/orderController.test.js:257:25)

node.exe : FAIL 
tests/orderController.test.js
At C:\Program 
Files\nodejs\npm.ps1:29 
char:3
+   & $NODE_EXE $NPM_CLI_JS 
$args
+   
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo           
   : NotSpecified: (FAIL te  
  sts/orderController.test   
 .js:String) [], RemoteEx    
ception
    + FullyQualifiedErrorId  
   : NativeCommandError
 
  Order Controller
    GET /api/orders
      ΓêÜ should return a 
list of orders (69 ms)
    GET /api/orders/:id
      ΓêÜ should return 
order details if found (15 
ms)
      ΓêÜ should return 404 
if order not found (10 ms)
    POST /api/orders
      ├ù should create a new 
order (110 ms)
      ├ù should return 400 
if product not found (25 ms)
    PUT /api/orders/:id
      ΓêÜ should update an 
order (18 ms)

  ΓùÅ Order Controller ΓÇ║ 
POST /api/orders ΓÇ║ should 
create a new order

    expect(received).toBe(exp
ected) // Object.is equality

    Expected: 201
    Received: 500

    [0m [90m 242 |[39m    
         }
     [90m 243 |[39m
    
[31m[1m>[22m[39m[90m 
244 |[39m             expect
(res[33m.[39mstatusCode)[3
3m.[39mtoBe([35m201[39m)[
33m;[39m
     [90m     |[39m        
                            
[31m[1m^[22m[39m
     [90m 245 |[39m        
     expect(res[33m.[39mbod
y[33m.[39mid)[33m.[39mtoB
e([32m'new-order-id'[39m)[
33m;[39m
     [90m 246 |[39m        
     expect(db[33m.[39m[33
mOrder[39m[33m.[39mcreate)
[33m.[39mtoHaveBeenCalled()
[33m;[39m
     [90m 247 |[39m        
 })[33m;[39m[0m

      at Object.toBe (tests/o
rderController.test.js:244:36
)

  ΓùÅ Order Controller ΓÇ║ 
POST /api/orders ΓÇ║ should 
return 400 if product not 
found

    expect(received).toBe(exp
ected) // Object.is equality

    Expected: 400
    Received: 500

    [0m [90m 258 |[39m    
         }
     [90m 259 |[39m
    
[31m[1m>[22m[39m[90m 
260 |[39m             expect
(res[33m.[39mstatusCode)[3
3m.[39mtoBe([35m400[39m)[
33m;[39m
     [90m     |[39m        
                            
[31m[1m^[22m[39m
     [90m 261 |[39m        
     expect(res[33m.[39mbod
y[33m.[39mmessage)[33m.[3
9mtoContain([32m'Product 
"Unknown" not 
found'[39m)[33m;[39m
     [90m 262 |[39m        
 })[33m;[39m
     [90m 263 |[39m     
})[33m;[39m[0m

      at Object.toBe (tests/o
rderController.test.js:260:36
)

Test Suites: 1 failed, 1 
total
Tests:       2 failed, 4 
passed, 6 total
Snapshots:   0 total
Time:        2.207 s, 
estimated 3 s
Ran all test suites matching 
tests/orderController.test.js
.
Force exiting Jest: Have you 
considered using 
`--detectOpenHandles` to 
detect async operations that 
kept running after all tests 
finished?
